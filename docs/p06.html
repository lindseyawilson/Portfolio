<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Portfolio 6</title>

<script src="site_libs/header-attrs-2.19/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Portfolio</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="p01.html">Portfolio 1</a>
</li>
<li>
  <a href="p02.html">Portfolio 2</a>
</li>
<li>
  <a href="p03.html">Portfolio 3</a>
</li>
<li>
  <a href="p04.html">Portfolio 4</a>
</li>
<li>
  <a href="p05.html">Portfolio 5</a>
</li>
<li>
  <a href="p06.html">Portfolio 6</a>
</li>
<li>
  <a href="p07.html">Portfolio 7</a>
</li>
<li>
  <a href="p08.html">Portfolio 8</a>
</li>
<li>
  <a href="p09.html">Portfolio 9</a>
</li>
<li>
  <a href="p10.html">Portfolio 10</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Portfolio 6</h1>

</div>


<div id="setup" class="section level2">
<h2>Setup</h2>
<p>I found another Tidy Tuesday dataset about measles vaccinations rates
for schools around the country between 2017 and 2019, and I want to see
what patterns jump out in the data. Let’s load the data and the packages
we’ll need here:</p>
<pre class="r"><code>library(tidyverse)
library(tidytuesdayR)

# Get data
tuesdata &lt;- tidytuesdayR::tt_load(&#39;2020-02-25&#39;)</code></pre>
<pre><code>## 
##  Downloading file 1 of 1: `measles.csv`</code></pre>
<pre class="r"><code>measles &lt;- tuesdata$measles</code></pre>
</div>
<div id="map" class="section level2">
<h2>Map</h2>
<p>First, let’s see what geographic area we’re working with in this
dataset. Longitude and latitude are included for each school’s entry in
the data, so we can just plot these against each other:</p>
<pre class="r"><code>measles %&gt;%
  ggplot(aes(y = lat, x = lng)) +
  geom_point(color = &quot;red&quot;)</code></pre>
<pre><code>## Warning: Removed 1549 rows containing missing values (`geom_point()`).</code></pre>
<p><img src="p06_files/figure-html/location-1.png" width="672" /></p>
<p>Let’s see if the image makes a little more sense if I filter out
schools with a longitude greater than zero:</p>
<pre class="r"><code>measles %&gt;%
  filter(lng &lt; 0) %&gt;%
  ggplot(aes(y = lat, x = lng)) +
  geom_point(color = &quot;red&quot;)</code></pre>
<p><img src="p06_files/figure-html/location-filtered-1.png" width="672" /></p>
<p>So we’re missing data grom some states, but it looks like we’ve got a
decent portion of the US covered. Just out of curiosity, let’s see where
the schools we just filtered out are actually located:</p>
<pre class="r"><code>measles_clean &lt;- measles %&gt;%
  filter(lng &lt; 0)

measles_clean</code></pre>
<pre><code>## # A tibble: 64,476 × 16
##    index state   year    name   type  city  county district enroll   mmr overall
##    &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;lgl&gt;     &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
##  1     1 Arizona 2018-19 A J M… Publ… Noga… Santa… NA           51   100      -1
##  2     2 Arizona 2018-19 Acade… Char… Tucs… Pima   NA           22   100      -1
##  3     3 Arizona 2018-19 Acade… Char… Tucs… Pima   NA           85   100      -1
##  4     4 Arizona 2018-19 Acade… Char… Phoe… Maric… NA           60   100      -1
##  5     5 Arizona 2018-19 Accla… Char… Phoe… Maric… NA           43   100      -1
##  6     6 Arizona 2018-19 Alfre… Publ… Phoe… Maric… NA           36   100      -1
##  7     7 Arizona 2018-19 All A… Char… Phoe… Maric… NA           24   100      -1
##  8     8 Arizona 2018-19 Ameri… Char… Yuma  Yuma   NA           22   100      -1
##  9     9 Arizona 2018-19 Arizo… Priv… Phoe… Maric… NA           26   100      -1
## 10    10 Arizona 2018-19 Arizo… Publ… San … Yuma   NA           78   100      -1
## # ℹ 64,466 more rows
## # ℹ 5 more variables: xrel &lt;lgl&gt;, xmed &lt;dbl&gt;, xper &lt;dbl&gt;, lat &lt;dbl&gt;, lng &lt;dbl&gt;</code></pre>
<p>Apparently most of these schools are supposed to be in Vermont, but
the points don’t fall into the continental United States when I plot
them. We’re going to work with the filtered dataset moving forward, just
because I don’t totally trust these data points to be accurate.</p>
</div>
<div id="merging-with-political-data" class="section level2">
<h2>Merging with Political Data</h2>
<p>A good first step towards figuring out what’s actually going on with
vaccinations here would be just to make a histogram of vaccination
rates, both overall and for measles specifically:</p>
<pre class="r"><code>#Overall vaccination rate
measles %&gt;%
  filter(overall != -1) %&gt;%
  ggplot(aes(x = overall)) + 
  geom_histogram(binwidth = 5, color = &quot;black&quot;, fill = &quot;blue&quot;)</code></pre>
<p><img src="p06_files/figure-html/histogram-1.png" width="672" /></p>
<pre class="r"><code>#Measles vaccination rate
measles %&gt;%
  filter(mmr != -1) %&gt;%
  ggplot(aes(x = mmr)) + 
  geom_histogram(binwidth = 5, color = &quot;black&quot;, fill = &quot;blue&quot;)</code></pre>
<p><img src="p06_files/figure-html/histogram-2.png" width="672" /></p>
<p>So it looks like the distributions of MMR vaccination and overall
vaccination aren’t shaped very differently (both are pretty
substantially) positively skewed, but MMR vaccination appears to be more
common than overall vaccination. This makes sense – the MMR vaccine is
just one shot, but overall vaccination requires consistently sticking to
a vaccine schedule.</p>
<p>Now here’s what I’m curious about: does a state’s political
affiliation influence the rates at which people in that state get
vaccinated? These data were collected before COVID, so it would be
interesting to see how closely vaccination rates and politics related in
the pre-COVID era.</p>
<p>To do this though, we first need info on the political affiliation of
each state. Luckily, I was able to find a dataset from MIT giving
detailed information about elections for each state since 1976. Let’s
load that in below:</p>
<pre class="r"><code>states &lt;- read_csv(&quot;/Users/lawilson1999/Desktop/Data Science Spring 2023/Portfolio/p06/1976-2020-president.csv&quot;)</code></pre>
<p>Each entry in the dataset represents the performance of a given
candidate in a given state for each presidential election since 1976.
That means we’re going to have to do some pretty serious processing for
this to be useful to us. That includes:</p>
<ul>
<li><p>Filtering the results to the 2016 election, as that was the most
recent election before the data was collected</p></li>
<li><p>Filtering out the candidates aside from those of the major party
nominees. In this case, that means everyone except Hilary Clinton and
Donald Trump</p></li>
<li><p>Figuring out for each state which of those two candidates
received the most votes in each state, and retaining the party
affiliation of that candidate</p></li>
</ul>
<p>Let’s do that below:</p>
<pre class="r"><code># Filter for 2016 election and for major party candidates
states_2016 &lt;- states %&gt;%
  filter(year == 2016) %&gt;%
  filter(candidate == &quot;CLINTON, HILLARY&quot; | candidate == &quot;TRUMP, DONALD J.&quot;)

#Calculate which candidate won more votes
state_max_votes &lt;- states_2016 %&gt;%
  group_by(state) %&gt;%
  summarize(max(candidatevotes))


names(state_max_votes)[2] &lt;- &quot;maxvotes&quot;

state_winners &lt;- merge(states_2016, state_max_votes, by = &quot;state&quot;)

#Filter out the losing candidate in each state
state_winners &lt;- state_winners %&gt;%
  filter(candidatevotes == maxvotes)

#Save states and party affiliations as a standalone data frame
state_parties &lt;- state_winners %&gt;%
  select(state, party_simplified) %&gt;%
  mutate(state = str_to_title(state))

head(state_parties)</code></pre>
<pre><code>##        state party_simplified
## 1    Alabama       REPUBLICAN
## 2     Alaska       REPUBLICAN
## 3    Arizona       REPUBLICAN
## 4   Arkansas       REPUBLICAN
## 5 California         DEMOCRAT
## 6   Colorado         DEMOCRAT</code></pre>
<p>Looks like it worked! Now that we have out list of states and
political affiliations, we can merge it with the measles data:</p>
<pre class="r"><code>measles_politics &lt;- merge(measles_clean, state_parties,  by = &quot;state&quot;)</code></pre>
</div>
<div id="vaccinations-by-political-affiliation" class="section level2">
<h2>Vaccinations by Political Affiliation</h2>
<p>Now that we have the data formatted the way we want, we can take a
look at what’s going on. Let’s visualize differences in vaccinations for
red and blue states:</p>
<pre class="r"><code># Overall vaccination
measles_politics %&gt;%
  filter(overall != -1) %&gt;%
  ggplot(aes(x = overall, fill = party_simplified)) +
  geom_density(alpha = 0.5) +
  scale_fill_manual(values = c(&quot;blue&quot;,  &quot;red&quot;)) + 
  facet_wrap(~party_simplified)</code></pre>
<p><img src="p06_files/figure-html/visualize-vaccination-by-politics-1.png" width="672" /></p>
<pre class="r"><code># MMR vaccination specifically
measles_politics %&gt;%
  filter(mmr != -1) %&gt;%
  ggplot(aes(x = mmr, fill = party_simplified)) +
  geom_density(alpha = 0.5) +
  scale_fill_manual(values = c(&quot;blue&quot;,  &quot;red&quot;)) + 
  facet_wrap(~party_simplified)</code></pre>
<p><img src="p06_files/figure-html/visualize-vaccination-by-politics-2.png" width="672" /></p>
<p>For both red and blue states, it looks like there’s still heavy
positive skew in both overall and MMR vaccination rates, suggesting that
people are generally likely to vaccinate their children regardless of
political affiliation. However, it also seems like parents in blue
states are fairly substantially more likely to fully vaccinate their
kids than parents in red states.</p>
<p>Just to confirm this intuition, let’s compare red and blue states
vaccination rates inferentially with t-tests:</p>
<pre class="r"><code># filter out vaccination values of -1
measles_politics_filt_overall &lt;- measles_politics %&gt;%
  filter(overall != -1)

measles_politics_filt_mmr &lt;- measles_politics %&gt;%
  filter(mmr != -1)

# Overall vaccination
t.test(overall ~ party_simplified, measles_politics_filt_overall, alternative = &quot;two.sided&quot;)</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  overall by party_simplified
## t = 19.109, df = 33331, p-value &lt; 2.2e-16
## alternative hypothesis: true difference in means between group DEMOCRAT and group REPUBLICAN is not equal to 0
## 95 percent confidence interval:
##  1.727684 2.122615
## sample estimates:
##   mean in group DEMOCRAT mean in group REPUBLICAN 
##                 93.44583                 91.52068</code></pre>
<pre class="r"><code># MMR vaccination
t.test(mmr ~ party_simplified, measles_politics_filt_mmr, alternative = &quot;two.sided&quot;)</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  mmr by party_simplified
## t = 26.979, df = 13300, p-value &lt; 2.2e-16
## alternative hypothesis: true difference in means between group DEMOCRAT and group REPUBLICAN is not equal to 0
## 95 percent confidence interval:
##  2.674026 3.093029
## sample estimates:
##   mean in group DEMOCRAT mean in group REPUBLICAN 
##                 95.72637                 92.84284</code></pre>
<p>So again, based on this it seems like even pre-COVID, vaccination
rates in blue states were higher than those in red states.</p>
<p>I have some more questions about this data, but this project is
already going long so I’m going to use my next one to dig into this data
some more!</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
