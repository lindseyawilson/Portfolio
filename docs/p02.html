<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Portfolio 2</title>

<script src="site_libs/header-attrs-2.19/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Portfolio</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="p01.html">Portfolio 1</a>
</li>
<li>
  <a href="p02.html">Portfolio 2</a>
</li>
<li>
  <a href="p03.html">Portfolio 3</a>
</li>
<li>
  <a href="p04.html">Portfolio 4</a>
</li>
<li>
  <a href="p05.html">Portfolio 5</a>
</li>
<li>
  <a href="p06.html">Portfolio 6</a>
</li>
<li>
  <a href="p07.html">Portfolio 7</a>
</li>
<li>
  <a href="p08.html">Portfolio 8</a>
</li>
<li>
  <a href="p09.html">Portfolio 9</a>
</li>
<li>
  <a href="p10.html">Portfolio 10</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Portfolio 2</h1>

</div>


<div id="background" class="section level3">
<h3>Background</h3>
<p>We just finished collecting data for the last study of my first-year
project, so I’m going to take this as an opportunity to analyze that
data. Additionally, this accomplishes two goals: 1.) I get to learn how
to do ANOVAs in R, and 2.) I get more practice with data visualization,
which gets me some nice figures for the paper we’re writing up.</p>
<p>Some context on the project. Essentially, we trained rats to press a
button in exchange for sugar. The catch is that the sugar pellets are
harder to earn as the session continues. The first time they press, they
get a pellet right away. However, to get the next one they have to press
3 times, then 5, then 7…so on and so forth. The overall pattern is that
in order to receive the nth pellet, the rats have to press 2n-1
additional times. As you can imagine, they eventually get tired of this
game, and we measure the point at which they give up as an index of
their motivation.</p>
<p>Specifically, we took 4 dependent measures:</p>
<p>1.) The number of presses on the active lever, where responding
earned a sugar reward 2.) The number of presses on the inactive lever,
which was right next to the active lever but never earned the rat any
sugar. We measure this to make sure the rat is specifically trying to
earn sugar, as opposed to just generally running around the cage and
indiscriminately mashing either lever. 3.) The total number of
reinforcers (sugar pellets) the rat earned 4.) Breakpoint – the number
of responses between the penultimate and the final sugar pellet of the
session. This is DV we care about the most, and it works out to be
double the number of reinforcers earned.</p>
<p>We then gave them a drug that, based on some results from my first
year project, we thought would decrease their motivation. In the context
of this experiment, that means fewer presses, a smaller breakpoint, and
fewer reinforcers (sugar pellets earned). As you will see shortly, this
is not what we found, but it helps to have some idea what we were going
for. We gave the drug in two doses (LO and HI) along with a control dose
of saline vehicle (VEH)</p>
</div>
<div id="setup" class="section level3">
<h3>Setup</h3>
<p>With all that exposition out of the way, we can go ahead and get
started. First, let’s load the packages and data we’ll need:</p>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
## ✔ ggplot2 3.4.0      ✔ purrr   1.0.1 
## ✔ tibble  3.1.8      ✔ dplyr   1.0.10
## ✔ tidyr   1.3.0      ✔ stringr 1.5.0 
## ✔ readr   2.1.3      ✔ forcats 0.5.2 
## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>library(haven)
library(rstatix)</code></pre>
<pre><code>## 
## Attaching package: &#39;rstatix&#39;
## 
## The following object is masked from &#39;package:stats&#39;:
## 
##     filter</code></pre>
<pre class="r"><code>library(ggpubr)

breakpoint &lt;- read_sav(&quot;/Users/lawilson1999/Desktop/Data Science Spring 2023/Portfolio/p02/HZ_Breakpoint.sav&quot;)
active &lt;- read_sav(&quot;/Users/lawilson1999/Desktop/Data Science Spring 2023/Portfolio/p02/HZ_TotalLeverPresses.sav&quot;)
reinforcers &lt;- read_sav(&quot;/Users/lawilson1999/Desktop/Data Science Spring 2023/Portfolio/p02/HZ_Reinforcers.sav&quot;)
inactive &lt;- read_sav(&quot;/Users/lawilson1999/Desktop/Data Science Spring 2023/Portfolio/p02/HZ_InactiveLever.sav&quot;)</code></pre>
<p>As you can see, we have a separate data file for each dependent
variable, and the plan is to do a one-way repeated measures ANOVA with
drug dose as the independent variable for each one. One could probably
make a pretty good case that we should do a multivariate ANOVA before we
do anything else, but I’ve never seen that done in a paper like this –
and my understanding is that multivariate ANOVA has some issues of it’s
own. We’re going to skip it here.</p>
<p>If we want to do an ANOVA though, first we’ll need an ANOVA package.
One I was able to find is called <code>rstatix</code>.</p>
<p>The package requires data to be in long form, but the data as we
currently have it is wide. We can reformat it below:</p>
<pre class="r"><code>active_long &lt;- active %&gt;%
   pivot_longer(cols = -Rat,
               names_to = &quot;dose&quot;)

inactive_long &lt;- inactive %&gt;%
   pivot_longer(cols = -Rat,
               names_to = &quot;dose&quot;)

reinforcers_long &lt;- reinforcers %&gt;%
  pivot_longer(cols = -Rat,
               names_to = &quot;dose&quot;)

breakpoint_long &lt;- breakpoint %&gt;%
  pivot_longer(cols = -Rat,
               names_to = &quot;dose&quot;)</code></pre>
<p>And now that we have the data set up the way we want it, we can start
running our ANOVAs themselves</p>
<pre class="r"><code>active_results &lt;- anova_test(data = active_long,
                             dv = value,
                             wid = Rat,
                             within = dose)

inactive_results &lt;- anova_test(data = inactive_long,
                             dv = value,
                             wid = Rat,
                             within = dose)

reinforcers_results &lt;- anova_test(data = reinforcers_long,
                             dv = value,
                             wid = Rat,
                             within = dose)

breakpoint_results &lt;- anova_test(data = breakpoint_long,
                             dv = value,
                             wid = Rat,
                             within = dose)</code></pre>
<p>And just like that, we have our calculations out of the way! Let’s
take a look at how things turned out, starting with active lever
presses:</p>
<pre class="r"><code>get_anova_table(active_results)</code></pre>
<pre><code>## ANOVA Table (type III tests)
## 
##   Effect DFn DFd     F     p p&lt;.05   ges
## 1   dose   2  16 0.655 0.533       0.021</code></pre>
<p>So overall it looks like there wasn’t a significant effect of drug
dose on active lever presses. Adding a visualization might help us to
get a better idea of what’s going on:</p>
<pre class="r"><code>active_long %&gt;%
  ggbarplot(x = &quot;dose&quot;,
            y = &quot;value&quot;,
            add = c(&quot;mean_se&quot;),
            fill = &quot;darkgrey&quot;,
            ylab = &quot;Active Lever Presses&quot;)</code></pre>
<p><img src="p02_files/figure-html/active-viz-1.png" width="672" /></p>
<p>As we can see, there’s some pretty significant overlap in the error
bars, which here represent standard errors.</p>
<p>Since breakpoint and number of reinforcers are both based on the
number of active lever presses, we see a similar pattern of results for
those two dependent variables as well:</p>
<pre class="r"><code>reinforcers_long %&gt;%
  ggbarplot(x = &quot;dose&quot;,
            y = &quot;value&quot;,
            add = c(&quot;mean_se&quot;),
            fill = &quot;darkgrey&quot;,
            ylab = &quot;Reinforcers&quot;)</code></pre>
<p><img src="p02_files/figure-html/breakpoint-reinforcer-viz-1.png" width="672" /></p>
<pre class="r"><code>breakpoint_long %&gt;%
  ggbarplot(x = &quot;dose&quot;,
            y = &quot;value&quot;,
            add = c(&quot;mean_se&quot;),
            fill = &quot;darkgrey&quot;,
            ylab = &quot;Breakpoint&quot;)</code></pre>
<p><img src="p02_files/figure-html/breakpoint-reinforcer-viz-2.png" width="672" /></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
