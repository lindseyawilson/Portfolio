<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Portfolio 1</title>

<script src="site_libs/header-attrs-2.19/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Portfolio</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="p01.html">Portfolio 1</a>
</li>
<li>
  <a href="p02.html">Portfolio 2</a>
</li>
<li>
  <a href="p03.html">Portfolio 3</a>
</li>
<li>
  <a href="p04.html">Portfolio 4</a>
</li>
<li>
  <a href="p05.html">Portfolio 5</a>
</li>
<li>
  <a href="p06.html">Portfolio 6</a>
</li>
<li>
  <a href="p07.html">Portfolio 7</a>
</li>
<li>
  <a href="p08.html">Portfolio 8</a>
</li>
<li>
  <a href="p09.html">Portfolio 9</a>
</li>
<li>
  <a href="p10.html">Portfolio 10</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Portfolio 1</h1>

</div>


<pre class="r"><code>library(tidyverse) 
library(tidyr)
knitr::opts_chunk$set(echo = TRUE)</code></pre>
<p>My goal in this first portfolio project is to recreate a graph from
my first year project poster. A screenshot of the graph is below:</p>
<p><img src="p01/data/FirstYearProjGraph.png" width="614" /></p>
<p>The first thing we need to do is import the data, which I’ve done
below. The data was originally wide, and I restructured it to long
format in SPSS. Definitely not a long-term solution, but I wanted this
project to focus on the graphics (I’ll try the restructuring in R for
one of my future portfolio projects).</p>
<pre class="r"><code>library(haven)
data &lt;- read_sav(&quot;/Users/lawilson1999/Desktop/Data Science Spring 2023/Portfolio/p01/data/Long_HWInitialAnalysis.sav&quot;)</code></pre>
<p>Let’s check out what this dataset looks like:</p>
<pre class="r"><code>head(data)</code></pre>
<pre><code>## # A tibble: 6 × 5
##      id rat   Dose       Time Intake
##   &lt;dbl&gt; &lt;chr&gt; &lt;dbl+lbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
## 1     1 HW2   1 [VEH]       1   1.48
## 2     1 HW2   1 [VEH]       2   2.57
## 3     1 HW2   1 [VEH]       3   2.58
## 4     1 HW2   1 [VEH]       4   2.56
## 5     1 HW2   1 [VEH]       5   2.58
## 6     1 HW2   1 [VEH]       6   2.58</code></pre>
<pre class="r"><code>names(data)</code></pre>
<pre><code>## [1] &quot;id&quot;     &quot;rat&quot;    &quot;Dose&quot;   &quot;Time&quot;   &quot;Intake&quot;</code></pre>
<p>This is mostly what we wanted, but I want to create a new variable so
that the dose groups aren’t indexed just by numbers. For example, a dose
code of 1 indicates the saline treatment, but that isn’t obvious at all
from the table we have here. Let’s go ahead and make that change:</p>
<pre class="r"><code>data &lt;- data %&gt;%
  mutate(dosename = case_when(Dose == 1 ~ &#39;VEH&#39;,
                             Dose == 2 ~ &#39;LO&#39;,
                             Dose == 3 ~ &#39;MED&#39;,
                             Dose == 4 ~ &#39;HI&#39;,
                             Dose == 5 ~ &#39;DAMGO&#39;))</code></pre>
<p>It’s also a little unclear what the time variable in the existing
dataset means. Cumulative food intake for each animal was measured every
five minutes, so we need to multiply the time variable by 5 so that our
time variable actually gives us the number of minutes since the feeding
session started:</p>
<pre class="r"><code>data &lt;- data %&gt;%
  mutate(realtime = Time * 5)</code></pre>
<p>And now that we’ve finished wrangling our data we can start graphing.
Let’s just give it a very rough first pass to see what happens when I
plot intake over time:</p>
<pre class="r"><code>ggplot(data = data, mapping = aes(x = realtime,
                                  y = Intake,
                                  color = dosename)) + 
  geom_point() + 
  geom_line() </code></pre>
<p><img src="p01_files/figure-html/first-pass-1.png" width="672" /></p>
<p>At this point I realized that the points in my original plot are
group <em>means</em>, and the points in my current data frame are from
individual animals. Just to follow this line of thinking, I’m going to
graph the data from each animal separately. Each plot should have the
same general form of the original plot (the plot I want), and that will
at least confirm that nothing went horribly wrong in my data
processing:</p>
<pre class="r"><code>ggplot(data = data, mapping = aes(x = realtime,
                     y = Intake,
                     color = dosename)) + 
  geom_point() + 
  geom_line() +
  facet_wrap(~ rat, ncol = 2)</code></pre>
<p><img src="p01_files/figure-html/confirmation-1.png" width="672" /></p>
<p>This is good! The data is set up the way I expected. Each point does
give cumulative intake (since none of the lines go down), and the DAMGO
line for each animal ends up being the highest (since DAMGO was our
positive control). This confirms that the next step is to average across
animal groups, and calculate standard deviations for the error bars.</p>
<p>Let’s give that a shot here. I went ahead and restructured the data
outside of R (again, to focus on visualization here), so I’ll import the
new dataset below and filter it so that we only have the rows we
want:</p>
<pre class="r"><code>means_sds &lt;- read_sav(&quot;/Users/lawilson1999/Desktop/Data Science Spring 2023/Portfolio/p01/data/Descriptives_HWData.sav&quot;)
means_sds &lt;- means_sds %&gt;%
  filter(rat == &quot;Average&quot; | rat == &quot;StDev&quot;)</code></pre>
<p>Next we’ll take it through the same processing pipeline we did with
our first dataset to create meaningful dose and time variables</p>
<pre class="r"><code>means_sds &lt;- means_sds %&gt;%
  mutate(dosename = case_when(Dose == 1 ~ &#39;VEH&#39;,
                             Dose == 2 ~ &#39;LO&#39;,
                             Dose == 3 ~ &#39;MED&#39;,
                             Dose == 4 ~ &#39;HI&#39;,
                             Dose == 5 ~ &#39;DAMGO&#39;))
means_sds &lt;- means_sds %&gt;%
  mutate(realtime = Time * 5)</code></pre>
<p>And now we should be ready to try to plot it again:</p>
<pre class="r"><code>means_sds %&gt;%
  filter(rat == &quot;Average&quot;) %&gt;%
ggplot(mapping = aes(x = realtime,
                     y = Intake,
                     color = dosename)) + 
  geom_point() + 
  geom_line()</code></pre>
<p><img src="p01_files/figure-html/graph-second-pass-1.png" width="672" /></p>
<p>Perfect! Still needs a few touches, but this is exactly what we were
hoping for. Next thing to do to recreate the original plot is to filter
out some of these groups. We ended up not displaying the DAMGO and LO
groups on the poster, the former because we really only did it as a
manipulation check and the latter because it was very similar to the MED
group but made the graph difficult to parse visually. These are filtered
out below</p>
<pre class="r"><code>means_sds %&gt;%
  filter(rat == &quot;Average&quot;,
         dosename == &quot;VEH&quot; | dosename == &quot;MED&quot; | dosename == &quot;HI&quot;) %&gt;%
ggplot(mapping = aes(x = realtime,
                     y = Intake,
                     color = dosename)) + 
  geom_point() + 
  geom_line()</code></pre>
<p><img src="p01_files/figure-html/graph-with-groups-filtered-1.png" width="672" /></p>
<p>Next let’s turn to the error bars. I realized at this point the data
as I have it isn’t really set up for me to add error bars, but since
this project is consistently requiring data restructuring I figure I may
as well try to do this bout of it in R. Let’s try it below:</p>
<pre class="r"><code>#Puts the data we&#39;ve been working with in wide format
data_wider &lt;- means_sds %&gt;%
  pivot_wider(names_from = rat,
              values_from = Intake)
#Creates a subset of the data by extracting the dose, time, and mean
data_means &lt;- data_wider[,c(&#39;dosename&#39;, &#39;realtime&#39;, &#39;Average&#39;)]
data_means &lt;- data_means %&gt;%
  slice_head(n=120)
#Creates a subset of the data by extracting the dose, time, and standard deviation
data_sds &lt;- data_wider[,c(&#39;dosename&#39;, &#39;realtime&#39;, &#39;StDev&#39;)]
data_sds &lt;- data_sds %&gt;%
  slice_tail(n=120)
#Merges the two subsets we just created
data_proper &lt;- merge(data_means,data_sds)</code></pre>
<p>Now that we’ve essentially created our own dataset from scratch,
we’re ready to try graphing it.</p>
<pre class="r"><code>data_proper %&gt;%
  filter(dosename == &quot;VEH&quot; | dosename == &quot;MED&quot; | dosename == &quot;HI&quot;) %&gt;%
ggplot(mapping = aes(x = realtime,
                     y = Average,
                     color = dosename)) + 
  geom_point() + 
  geom_line() + 
  geom_errorbar(aes(ymin = Average - (StDev/sqrt(7)), ymax = Average + StDev/sqrt(7))) +
#I realized the error bars actually were standard errors, so I divided StDev by sqrt(7) to convert
  labs(title = &quot;Ad Libitum Food Intake Over Time&quot;,
       x = &quot;Time (min)&quot;, 
       y = &quot;Intake (Kilocalories)&quot;,
       color = &quot;Dosage&quot;)</code></pre>
<p><img src="p01_files/figure-html/graph-with-error-bars-1.png" width="672" /></p>
<p>And here we have our finished plot!</p>
<p>I want to point out that this plot is good, but it isn’t
<em>great</em>. An alternative way to represent it that jumps out at me
is to use a smooth:</p>
<pre class="r"><code>data %&gt;%
  filter(dosename == &quot;VEH&quot; | dosename == &quot;MED&quot; | dosename == &quot;HI&quot;) %&gt;%
ggplot(mapping = aes(x = realtime,
                     y = Intake,
                     color = dosename)) + 
  geom_point() + 
  geom_smooth() +
  labs(title = &quot;Ad Libitum Food Intake Over Time&quot;,
       x = &quot;Time (min)&quot;, 
       y = &quot;Intake (Kilocalories)&quot;,
       color = &quot;Dosage&quot;)</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="p01_files/figure-html/smooth-alternative-1.png" width="672" />
A little messy, but there’s potential I think!</p>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
