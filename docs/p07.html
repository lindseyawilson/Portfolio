<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Portfolio 7</title>

<script src="site_libs/header-attrs-2.19/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Portfolio</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="p01.html">Portfolio 1</a>
</li>
<li>
  <a href="p02.html">Portfolio 2</a>
</li>
<li>
  <a href="p03.html">Portfolio 3</a>
</li>
<li>
  <a href="p04.html">Portfolio 4</a>
</li>
<li>
  <a href="p05.html">Portfolio 5</a>
</li>
<li>
  <a href="p06.html">Portfolio 6</a>
</li>
<li>
  <a href="p07.html">Portfolio 7</a>
</li>
<li>
  <a href="p08.html">Portfolio 8</a>
</li>
<li>
  <a href="p09.html">Portfolio 9</a>
</li>
<li>
  <a href="p10.html">Portfolio 10</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Portfolio 7</h1>

</div>


<p>What I did in my last portfolio was pair some data I found on
vaccination rates in schools with election data I found that gave each
state’s general political affiliation. In this portfolio I want to do
some deeper analysis on that data to see what additional questions we
can answer.</p>
<p>Let’s get set up and recreate the data we made last time first:</p>
<pre class="r"><code># Load packages
library(tidyverse)
library(tidytuesdayR)
library(parsnip)

# Get data
tuesdata &lt;- tidytuesdayR::tt_load(&#39;2020-02-25&#39;)</code></pre>
<pre><code>## 
##  Downloading file 1 of 1: `measles.csv`</code></pre>
<pre class="r"><code>measles &lt;- tuesdata$measles
states &lt;- read_csv(&quot;/Users/lawilson1999/Desktop/Data Science Spring 2023/Portfolio/p06/1976-2020-president.csv&quot;)

# Process data to merge vaccination data with election info (see portfolio 6 for details)
measles_clean &lt;- measles %&gt;%
  filter(lng &lt; 0)


states_2016 &lt;- states %&gt;%
  filter(year == 2016) %&gt;%
  filter(candidate == &quot;CLINTON, HILLARY&quot; | candidate == &quot;TRUMP, DONALD J.&quot;)


state_max_votes &lt;- states_2016 %&gt;%
  group_by(state) %&gt;%
  summarize(max(candidatevotes))


names(state_max_votes)[2] &lt;- &quot;maxvotes&quot;

state_winners &lt;- merge(states_2016, state_max_votes, by = &quot;state&quot;)


state_winners &lt;- state_winners %&gt;%
  filter(candidatevotes == maxvotes)


state_parties &lt;- state_winners %&gt;%
  select(state, party_simplified) %&gt;%
  mutate(state = str_to_title(state))

measles_politics &lt;- merge(measles_clean, state_parties,  by = &quot;state&quot;)</code></pre>
<div id="mmr-vs.-overall-vaccination" class="section level2">
<h2>MMR vs. Overall Vaccination</h2>
<p>The first question I have: how closely are measles vaccination rates
related to overall vaccination rates. In other words, to what extent
does giving your child a single vaccination predict your likelihood to
give your child a full course of vaccinations? Let’s find out:</p>
<pre class="r"><code># Zero order correlation
measles_politics_clean &lt;- measles_politics %&gt;%
  filter(mmr != -1) %&gt;%
  filter(overall != -1)
cor(measles_politics_clean$mmr, measles_politics_clean$overall)</code></pre>
<pre><code>## [1] 0.8986528</code></pre>
<pre class="r"><code># Linear model predicting overall vaccination rate from MMR vaccination rate
m_overall_mmr &lt;- linear_reg() %&gt;%
  set_engine(&quot;lm&quot;) %&gt;%
  fit(overall ~ mmr, data = measles_politics_clean)
tidy(m_overall_mmr)</code></pre>
<pre><code>## # A tibble: 2 × 5
##   term        estimate std.error statistic p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
## 1 (Intercept)   -15.6    0.361       -43.3       0
## 2 mmr             1.14   0.00379     301.        0</code></pre>
<pre class="r"><code>glance(m_overall_mmr)</code></pre>
<pre><code>## # A tibble: 1 × 12
##   r.squared adj.r.squared sigma statistic p.value    df  logLik     AIC     BIC
##       &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
## 1     0.808         0.808  4.31    90745.       0     1 -62294. 124593. 124617.
## # ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
<pre class="r"><code># Visualization
measles_politics_clean %&gt;%
  ggplot(aes(x = mmr, y = overall)) +
  geom_jitter() +
  geom_smooth(method = &quot;lm&quot;)</code></pre>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="p07_files/figure-html/mmr-overall-1.png" width="672" /></p>
<p>Unsurprisingly, the two variables are very highly correlated, and
knowing a school’s MMR vaccination rate explains more than 80% of the
variance in overall vaccination rate. It looks like, as a general rule,
people are pretty likely to finish a course of vaccines once they
start.</p>
</div>
<div id="predicting-vaccination-rate-from-political-affiliation"
class="section level2">
<h2>Predicting Vaccination Rate from Political Affiliation</h2>
<p>Next, I’m curious as to how predictive a state’s political
affiliation is of its overall vaccination rate. We. know from portfolio
6 that there is a. significant difference between red and blue states in
both MMR and overall vaccination, but how much variance does that
difference actually explain?</p>
<p>Let’s find out:</p>
<pre class="r"><code># Linear model predicting overall vaccination rate from state political affiliation
m_overall_politics &lt;- linear_reg() %&gt;%
  set_engine(&quot;lm&quot;) %&gt;%
  fit(overall ~ party_simplified, data = measles_politics_clean)
tidy(m_overall_politics)</code></pre>
<pre><code>## # A tibble: 2 × 5
##   term                       estimate std.error statistic  p.value
##   &lt;chr&gt;                         &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)                   93.2     0.0712    1309.  0       
## 2 party_simplifiedREPUBLICAN    -4.04    0.194      -20.9 1.07e-95</code></pre>
<pre class="r"><code>glance(m_overall_politics)</code></pre>
<pre><code>## # A tibble: 1 × 12
##   r.squared adj.r.squared sigma statistic  p.value    df  logLik     AIC     BIC
##       &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
## 1    0.0197        0.0197  9.74      435. 1.07e-95     1 -79897. 159800. 159824.
## # ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
<pre class="r"><code>#Visualization
measles_politics_clean %&gt;%
  ggplot(aes(x = party_simplified, y = overall, fill = party_simplified)) +
  geom_violin(alpha = 0.5)+
  geom_boxplot(width = 0.1, coef = 30, alpha = 0.5) +
  scale_fill_manual(values = c(&quot;blue&quot;,  &quot;red&quot;))</code></pre>
<p><img src="p07_files/figure-html/vaccination-politics-lm-1.png" width="672" /></p>
<p>So the difference between red and blue states in vaccination rates is
significant (i.e., nonrandom), but it isn’t huge and it doesn’t explain
much variance in overall vaccination. Since overall vaccination and MMR
vaccination are so tightly correlated, I imagine the pattern won’t look
extremely different if we look at MMR exclusively, but for the sake of
completeness I think it’s worth taking a look at:</p>
<pre class="r"><code># Linear model predicting MMR vaccination rate from state political affiliation
m_mmr_politics &lt;- linear_reg() %&gt;%
  set_engine(&quot;lm&quot;) %&gt;%
  fit(mmr ~ party_simplified, data = measles_politics_clean)
tidy(m_mmr_politics)</code></pre>
<pre><code>## # A tibble: 2 × 5
##   term                       estimate std.error statistic   p.value
##   &lt;chr&gt;                         &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)                   95.3     0.0557    1710.  0        
## 2 party_simplifiedREPUBLICAN    -3.87    0.152      -25.5 3.76e-141</code></pre>
<pre class="r"><code>glance(m_mmr_politics)</code></pre>
<pre><code>## # A tibble: 1 × 12
##   r.squared adj.r.squared sigma statistic   p.value    df  logLik     AIC    BIC
##       &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;
## 1    0.0292        0.0291  7.62      649. 3.76e-141     1 -74606. 149218. 1.49e5
## # ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
<pre class="r"><code>#Visualization
measles_politics_clean %&gt;%
  ggplot(aes(x = party_simplified, y = mmr, fill = party_simplified)) +
  geom_violin(alpha = 0.5)+
  geom_boxplot(width = 0.05, coef = 30, alpha = 0.5) +
  scale_fill_manual(values = c(&quot;blue&quot;,  &quot;red&quot;))</code></pre>
<p><img src="p07_files/figure-html/MMR-politics-lm-1.png" width="672" />
It looks like state politics are a bit more predictive of MMR
vaccination rates than overall vaccination rates, but just like I
expected the general pattern of data is very similar.</p>
</div>
<div
id="effect-of-politics-on-the-link-between-mmr-and-overall-vaccination"
class="section level2">
<h2>Effect of Politics on the Link Between MMR and Overall
Vaccination</h2>
<p>Finally, I want to put everything I’ve done so far together and ask:
does political affiliation moderate the degree which MMR vaccination
predicts overall vaccination? In other words, are people less likely to
follow through with the full course of vaccines once they get the MMR
vaccine in red states than in blue states (or vice versa)? Calculating a
model with overall vaccination as the outcome variable and with
political affiliation and MMR rates as predictors should give me an
interaction term that answers that question:</p>
<pre class="r"><code># Linear model predicting overall vaccination rate from state political affiliation and MMR rates
m_overall_mmr_politics &lt;- linear_reg() %&gt;%
  set_engine(&quot;lm&quot;) %&gt;%
  fit(overall ~ mmr*party_simplified, data = measles_politics_clean)
tidy(m_overall_mmr_politics)</code></pre>
<pre><code>## # A tibble: 4 × 5
##   term                           estimate std.error statistic  p.value
##   &lt;chr&gt;                             &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)                    -17.4      0.433      -40.2  0       
## 2 mmr                              1.16     0.00453    256.   0       
## 3 party_simplifiedREPUBLICAN       5.49     0.797        6.89 5.77e-12
## 4 mmr:party_simplifiedREPUBLICAN  -0.0551   0.00856     -6.44 1.18e-10</code></pre>
<pre class="r"><code>glance(m_overall_mmr_politics)</code></pre>
<pre><code>## # A tibble: 1 × 12
##   r.squared adj.r.squared sigma statistic p.value    df  logLik     AIC     BIC
##       &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
## 1     0.808         0.808  4.31    30351.       0     3 -62263. 124536. 124576.
## # ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
<pre class="r"><code># Visualization
measles_politics_clean %&gt;%
  ggplot(aes(x = mmr, y = overall, color = party_simplified)) +
  geom_jitter(alpha = 0.1) +
  geom_smooth(method = &quot;lm&quot;) +
  scale_color_manual(values = c(&quot;blue&quot;,  &quot;red&quot;))</code></pre>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="p07_files/figure-html/moderation-1.png" width="672" /></p>
<p>It looks like my hunch was in the right direction. The interaction
term we have here suggests that a one percent increase in MMR
vaccination rates predicts slightly (but significantly) less of an
increase in overall vaccination for red states than blue states. In
other words, people in red states are less likely than those in blue
states to follow through with a full course of vaccination after the MMR
shot. However comparing the adjusted R-squared of this model with the
that of the original model from Part 1, we see that we’re only
explaining 0.1% more variance after factoring in state politics.</p>
</div>
<div id="conclusions" class="section level2">
<h2>Conclusions</h2>
<p>In conclusion, we’ve seen that:</p>
<ul>
<li><p>Vaccination rates are generally high</p></li>
<li><p>Vaccination rates are lower in red states than blue
states</p></li>
<li><p>MMR vaccination predicts overall vaccination</p></li>
<li><p>People are slightly, but non-randomly, more likely to covert MMR
vaccinations into full vaccination courses in blue states than red
states</p></li>
</ul>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
